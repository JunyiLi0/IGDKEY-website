import{r as n,R as j,j as e}from"./index-BY1xkHAp.js";import{g as f}from"./Footer-CVpvx4qe.js";function w(){const[u,p]=n.useState(!1),[o,m]=n.useState(""),[r,i]=n.useState([{id:1,text:"Bonjour ! Je suis l'assistant IA d'IGDKEY. Comment puis-je vous aider ?",sender:"bot",timestamp:new Date}]),[c,h]=n.useState(!1),l=n.useRef(null),g=async()=>{if(!o.trim())return;const s={id:r.length+1,sender:"user",text:o,timestamp:new Date};i(t=>[...t,s]),m(""),h(!0);try{const t=await fetch("https://igdkey-backend.vercel.app/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s.text})});if(!t.ok){let a=`Erreur HTTP ${t.status}`;try{const x=await t.json();x.error&&(a=x.error)}catch{a=`Erreur HTTP ${t.status}: ${t.statusText}`}throw new Error(a)}const d=await t.json();i(a=>[...a,{id:r.length+2,sender:"bot",text:d.reply,timestamp:new Date}])}catch(t){console.error("Error:",t),i(d=>[...d,{id:r.length+2,sender:"bot",text:t.message,timestamp:new Date}])}finally{h(!1)}},y=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),g())};return j.useEffect(()=>{r.length>0&&l.current&&(l.current.scrollTop=l.current.scrollHeight)},[r]),e.jsxs(e.Fragment,{children:[!u&&e.jsx("button",{onClick:()=>p(!0),className:"fixed bottom-6 right-6 z-50 w-14 h-14 bg-pale-sky rounded-full shadow-lg hover:shadow-xl transition-all hover:scale-110 hover:cursor-pointer flex items-center justify-center","aria-label":"Ouvrir le chat",children:e.jsx("img",{src:f("/images/chat.png"),alt:"chat",className:"w-7 h-7 brightness-0"})}),u&&e.jsxs("div",{className:"fixed bottom-4 right-4 z-50 w-80 h-96 bg-onyx border border-dusty-grape rounded-lg shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dusty-grape",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-pale-sky rounded-full flex items-center justify-center",children:e.jsx("img",{src:f("/images/chat.png"),alt:"chat",className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-pale-sky font-semibold",children:"Assistant IGDKEY"}),e.jsx("p",{className:"text-slate-grey text-xs",children:"En ligne"})]})]}),e.jsx("button",{onClick:()=>p(!1),className:"text-pale-sky hover:text-mint-cream transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{ref:l,className:"flex-1 overflow-y-auto p-4 space-y-3",children:[r.map(s=>e.jsx("div",{className:`flex ${s.sender==="bot"?"justify-start":"justify-end"}`,children:e.jsxs("div",{className:`max-w-xs px-3 py-2 rounded-lg ${s.sender==="bot"?"bg-dusty-grape text-pale-sky":"bg-pale-sky text-onyx"}`,children:[e.jsx("p",{className:"text-sm",children:s.text}),e.jsx("p",{className:"text-xs opacity-70 mt-1",children:s.timestamp.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]})},s.id)),c&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-dusty-grape text-pale-sky px-3 py-2 rounded-lg",children:e.jsx("p",{className:"text-sm",children:"Envoi..."})})})]}),e.jsx("form",{onSubmit:s=>{s.preventDefault(),g()},className:"p-4 border-t border-dusty-grape",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:o,onChange:s=>m(s.target.value),onKeyDown:y,placeholder:"Tapez votre message...",className:"flex-1 px-3 py-2 bg-dusty-grape text-pale-sky rounded-md text-sm placeholder-slate-grey focus:outline-none focus:ring-2 focus:ring-pale-sky",disabled:c}),e.jsx("button",{type:"submit",disabled:c||!o.trim(),className:"px-4 py-2 bg-pale-sky text-onyx rounded-md hover:bg-mint-cream transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]})]})}export{w as default};
